<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>M√¥ ph·ªèng r√∫t b√†i t√¢y</title>
  <style>
    body {
      font-family: "Times New Roman", serif;
      margin: 20px;
      background: #f5f5f5;
      color: #000;
      transition: background 0.5s ease, color 0.5s ease;
    }
    body.dark { background: #1e1e1e; color: #f5f5f5; }
h1 {
  text-align: center;
  margin-bottom: 20px;
  color: #0B3D91; /* xanh ƒë·∫≠m */
  font-weight: bold;
}    h2 { margin-top: 20px; color: #8e44ad; }
    .container { display: flex; gap: 30px; }
    .col { flex: 1; padding: 15px; background: #fff; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.2); }
    body.dark .col { background: #2a2a2a; }
    button, select {
      margin: 8px;
      padding: 8px 16px;
      font-size: 15px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
    }
    button { background-color: #3498db; color: white; }
    button:hover { background-color: #2980b9; }
    select { background: #fff; border: 1px solid #ccc; cursor: pointer; }
    body.dark select { background: #333; color: #fff; border: 1px solid #777; }
    #ketqua, #lichsu, #thongke, #ketquaPoker { margin-top: 15px; font-size: 16px; }
    .card { display: inline-block; margin: 5px; }
    .card img { width: 90px; border-radius: 6px; box-shadow: 2px 2px 6px rgba(0,0,0,0.3); transition: transform 0.3s; }
    .card img:hover { transform: scale(1.1); }
    #toggleTheme {
      position: fixed; top: 15px; right: 15px;
      background: #333; color: #fff; border-radius: 50%;
      width: 38px; height: 38px;
      display: flex; justify-content: center; align-items: center;
      cursor: pointer; font-size: 18px; box-shadow: 0 2px 6px rgba(0,0,0,0.4);
    }
    #toggleTheme:hover { background: #555; transform: rotate(20deg); }
    .fade-card { opacity: 0; transform: translateY(20px); transition: opacity 0.8s ease, transform 0.8s ease; }
    .fade-card.show { opacity: 1; transform: translateY(0); }
    .formula { margin-top: 10px; }
    .prob-frac { color: red; font-weight: bold; }
    .prob-dec { color: green; font-weight: bold; }
  


.example-cards {
  margin-top: 8px;
  text-align: center;
}

.mini-card {
  width: 40px;
  margin: 0 2px;
  border-radius: 4px;
  box-shadow: 0 0 4px rgba(0,0,0,0.3);
}

body {
      margin: 0;
      font-family: Arial, sans-serif;
    }
    footer {
      position: fixed;
      bottom: 0;
      width: 100%;
      text-align: center;
      padding: 10px;
      font-size: 14px;
      background: #f0f0f0;
      color: #333;
      border-top: 1px solid #ccc;

      /* ch·ªëng copy / b√¥i ƒëen */
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
    }


</style>
  <!-- MathJax config -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['\\(','\\)']],   // c√¥ng th·ª©c trong d√≤ng
        displayMath: [['$$','$$']]     // c√¥ng th·ª©c xu·ªëng d√≤ng
      },
      svg: { fontCache: 'global' }     // d√πng SVG, render nhanh
    };
  </script>
  <script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
</head>
<body>
  <div id="toggleTheme">üåô</div>
 <h1 style="color:#0B3D91; font-weight:bold;">M√î PH·ªéNG R√öT B√ÄI T√ÇY ‚Äì X√ÅC SU·∫§T POKER</h1>

<div class="quote">
  <b>--X√°c su·∫•t l√† c√°ch l√†m cho ‚Äúc·∫£m gi√°c kh·∫£ nƒÉng‚Äù c·ªßa con ng∆∞·ªùi tr·ªü n√™n ch√≠nh x√°c b·∫±ng to√°n h·ªçc.--</b>
</div>

<style>
.quote {
  text-align: center;
  font-size: 18px;
  color: #d63384; /* m√†u t√≠m h·ªìng n·ªïi b·∫≠t */
  margin: 15px 0;
}
</style>

  <div class="container">
    <!-- C·ªôt tr√°i: R√∫t b√†i -->
    <div class="col">
      <h2>üéâR√∫t b√†iüÇ°</h2>
      <label for="mode"><b>Ch·∫ø ƒë·ªô r√∫t:</b></label>
      <select id="mode" onchange="capNhatThongKe()">
        <option value="khonghoanlai">Kh√¥ng ho√†n l·∫°i</option>
        <option value="hoanlai">Ho√†n l·∫°i</option>
      </select>
      <br>
      <button onclick="rutBai(1)">R√∫t 1 l√°</button>
      <button onclick="rutBai(2)">R√∫t 2 l√°</button>
      <button onclick="rutBai(3)">R√∫t 3 l√°</button>
      <button onclick="rutBai(5)">R√∫t 5 l√°</button>
      <button onclick="choiLai()">Ch∆°i l·∫°i</button>
      <div id="thongke"></div>
      <div id="ketqua"></div>
      <h3>L·ªãch s·ª≠ r√∫t b√†i</h3>
      <div id="lichsu" style="max-height:200px; overflow-y:auto;"></div>
    </div>

    <!-- C·ªôt ph·∫£i: X√°c su·∫•t Poker -->
    <div class="col">
      <h2>üé≤X√°c su·∫•t c√°c h·∫°ng b√†i Poker (X√¨ t·∫©y)</h2>
      <select id="handType" onchange="tinhXacSuatPoker()">
        <option value="">-- Ch·ªçn h·∫°ng b√†i --</option>
        <option value="royal_flush">Th√πng ph√° s·∫£nh (Royal Flush)</option>
        <option value="four_kind">T·ª© qu√Ω (Four Kind)</option>
        <option value="full_house">C√π l≈© (Full House)</option>
        <option value="flush">Th√πng (Flush)</option>
        <option value="straight">S·∫£nh (Straight)</option>
        <option value="three_kind">S√°m (Three of a kind)</option>
        <option value="two_pair">Th√∫ (2 ƒë√¥i)</option>
        <option value="one_pair">ƒê√¥i (One pair)</option>
        <option value="high_card">M·∫≠u th·∫ßu (High card)</option>
      </select>
      <div id="ketquaPoker"></div>
    </div>
  </div>

  <script>
    const suitMap = { "‚ô†":"S", "‚ô•":"H", "‚ô¶":"D", "‚ô£":"C" };
    const rankMap = { "A":"A", "J":"J", "Q":"Q", "K":"K", "10":"0" };

    let boBai = [], lichSu = [];

    function gcd(a,b){ return b===0 ? a : gcd(b, a%b); }
    function C(n, k) { if (k > n) return 0; let res = 1; for (let i = 1; i <= k; i++) res = res * (n - i + 1) / i; return res; }

    function taoBoBai() {
      const chat = ["‚ô†", "‚ô•", "‚ô¶", "‚ô£"];
      const so = ["A","2","3","4","5","6","7","8","9","10","J","Q","K"];
      let cards = [];
      for (let c of chat) for (let s of so) cards.push(s + c);
      return cards;
    }

    function choiLai() {
      boBai = taoBoBai();
      lichSu = [];
      document.getElementById("ketqua").innerHTML = "";
      document.getElementById("lichsu").innerHTML = "";
      document.getElementById("ketquaPoker").innerHTML = "";
      capNhatThongKe();
    }

    function rutBai(n) {
  let mode = document.getElementById("mode").value; 
  if (mode === "khonghoanlai" && boBai.length === 0) { 
    alert("H·∫øt b√†i r·ªìi!"); return; 
  }

  let laRut = [];
  for (let i = 0; i < n; i++) {
    if (mode === "khonghoanlai") {
      if (boBai.length === 0) break;
      let index = Math.floor(Math.random() * boBai.length);
      laRut.push(boBai[index]);
      boBai.splice(index, 1);
    } else { 
      let fullDeck = taoBoBai();
      let index = Math.floor(Math.random() * fullDeck.length);
      laRut.push(fullDeck[index]);
    }
  }

 let html = "<div style='display:flex; justify-content:center; gap:8px;'>";
laRut.forEach(card => {
  let rank = card.slice(0, -1); 
  let suit = card.slice(-1);   
  let rankCode = rankMap[rank] || rank; 
  let suitCode = suitMap[suit]; 
  let code = rankCode + suitCode; 
  let imgUrl = `cards/${code}.png`;  
  html += `<div class="card"><img class="fade-card" src="${imgUrl}" alt="${card}"></div>`;
});
html += "</div>";

  // T√≠nh x√°c su·∫•t
  let favorable = 1;
  let total = (mode === "khonghoanlai") ? C(52, n) : Math.pow(52, n);
  let g = gcd(favorable, total);
  let tu = favorable / g, mau = total / g;
  let p = favorable / total;

  html += `<div class="formula">X√°c xu·∫•t r√∫t ƒë∆∞·ª£c ${n} l√° tr√™n l√†:
              \\(P = \\dfrac{${tu}}{${mau}} \\;\\; \\approx ${p.toFixed(6)}\\)
           </div>`;

  const ketquaDiv = document.getElementById("ketqua");
  ketquaDiv.innerHTML = html;
  requestAnimationFrame(() => { 
    document.querySelectorAll(".fade-card").forEach(img => img.classList.add("show")); 
  });

  lichSu.push(...laRut);
  capNhatLichSu(); 
  capNhatThongKe();
  MathJax.typesetPromise();
}


    function capNhatLichSu() { document.getElementById("lichsu").innerHTML = lichSu.join(", "); }
    function capNhatThongKe() {
      let mode = document.getElementById("mode").value;
      if (mode === "khonghoanlai") document.getElementById("thongke").innerText = "S·ªë l√° c√≤n l·∫°i: " + boBai.length;
      else document.getElementById("thongke").innerText = "Ch·∫ø ƒë·ªô ho√†n l·∫°i: lu√¥n ƒë·ªß 52 l√°.";
    }

    const totalHands = C(52,5);

    function tinhXacSuatPoker(){
      const type = document.getElementById("handType").value;
      if (!type) { document.getElementById("ketquaPoker").innerHTML = ""; return; }
      let favorable = 0, formula = "", explain = "";

      switch(type){
        case "royal_flush":
          favorable = 4;
          formula = "$$4$$";
           handName = "th√πng ph√° s·∫£nh";
	explain = "Th√πng ph√° s·∫£nh: 10‚ÄìJ‚ÄìQ‚ÄìK‚ÄìA ƒë·ªìng ch·∫•t.";
          break; 
        case "four_kind":
          favorable = 13 * C(48,1);
          formula = "$$13 \\times C_{4}^{4} \\times 12 \\times C_{4}^{1}$$";
           handName = "t·ª© qu√Ω";
explain = "T·ª© qu√Ω: 4 l√° c√πng h·∫°ng + 1 l√° l·∫ª.";
          break;
        case "full_house":
          favorable = 13 * C(4,3) * 12 * C(4,2);
          formula = "$$13 \\times C_{4}^{3} \\times 12 \\times C_{4}^{2}$$";
 handName = "C√π l≈©";          
explain = "C√π l≈©: 1 b·ªô ba + 1 ƒë√¥i.";
          break;
        case "flush":
          favorable = 4 * C(13,5) - 40;
          formula = "$$4 \\times (C_{13}^{5} - 10)$$";
          handName = "th√πng";
 explain = "Th√πng: 5 l√° c√πng ch·∫•t, kh√¥ng li√™n ti·∫øp.";
          break; 
        case "straight":
          favorable = 10 * (4**5) - 40;
          formula = "$$10 \\times (C_{4}^{1})^5 - 40$$";
           handName = "s·∫£nh";
explain = "S·∫£nh: 5 l√° li√™n ti·∫øp kh√°c ch·∫•t.";
          break; 
        case "three_kind":
          favorable = 13 * C(4,3) * C(12,2) * (4**2);
          formula = "$$13 \\times C_{4}^{3} \\times C_{12}^{2} \\times (C_{4}^{1})^2$$";
           handName = "s√°m";
explain = "S√°m: 3 l√° c√πng h·∫°ng + 2 l√° kh√°c.";
          break;
        case "two_pair":
          favorable = C(13,2) * (C(4,2)**2) * 11 * 4;
          formula = "$$C_{13}^{2} \\times (C_{4}^{2})^2 \\times 11 \\times C_{4}^{1}$$";
 handName = "th√∫";          
explain = "Th√∫: 2 ƒë√¥i + 1 l√° l·∫ª.";
          break;
        case "one_pair":
          favorable = 13 * C(4,2) * C(12,3) * (4**3);
          formula = "$$13 \\times C_{4}^{2} \\times C_{12}^{3} \\times (C_{4}^{1})^3$$";
          explain = "ƒê√¥i: 1 ƒë√¥i + 3 l√° kh√°c.";
          break;
        case "high_card":
          favorable = totalHands - (4+13*C(48,1)+13*C(4,3)*12*C(4,2)+4*C(13,5)-40+(10*(4**5)-40)+13*C(4,3)*C(12,2)*(4**2)+C(13,2)*(C(4,2)**2)*11*4+13*C(4,2)*C(12,3)*(4**3));
          formula = "$$C_{52}^{5} - (\\text{c√°c tr∆∞·ªùng h·ª£p tr√™n})$$";
 handName = "m·∫≠u th·∫ßu";          
explain = "M·∫≠u th·∫ßu: kh√¥ng c√≥ ƒë√¥i, s·∫£nh, th√πng‚Ä¶";
          break;
      }

      let g = gcd(favorable, totalHands);
let tu = favorable / g, mau = totalHands / g;
let p = favorable / totalHands;

// HTML k·∫øt qu·∫£
let htmlResult = "";
htmlResult += "<div class='formula'>S·ªë k√™t qu·∫£ thu·∫≠n l·ª£i: " + formula + "</div>";
htmlResult += "<div class='formula'>X√°c su·∫•t 5 l√° ƒë∆∞·ª£c ch·ªçn t·∫°o th√†nh m·ªôt " + handName + " l√†:</div>";
htmlResult += "<div class='formula' style='text-align:center;'>\\( P = \\dfrac{" + tu + "}{" + mau + "} \\;\\; \\approx \\) " +
              "<span class='prob-dec'><b>" + p.toFixed(6) + "</b></span></div>";
htmlResult += "<div><br><b>Gi·∫£i th√≠ch:</b> " + explain + "</br></div>";

// H√¨nh minh h·ªça cho t·ª´ng lo·∫°i tay b√†i
let exampleCards = "";
switch(type){
  case "royal_flush":
    exampleCards = ["AS","KS","QS","JS","0S"]; break;
  case "four_kind":
    exampleCards = ["9S","9H","9D","9C","2H"]; break;
  case "full_house":
    exampleCards = ["3S","3H","3D","7S","7H"]; break;
  case "flush":
    exampleCards = ["2H","5H","8H","0H","QH"]; break;
  case "straight":
    exampleCards = ["6S","7D","8H","9C","0S"]; break;
  case "three_kind":
    exampleCards = ["4S","4H","4D","7S","9H"]; break;
  case "two_pair":
    exampleCards = ["5S","5H","9D","9C","2S"]; break;
  case "one_pair":
    exampleCards = ["6S","6H","3D","8C","JS"]; break;
  case "high_card":
    exampleCards = ["2S","5H","7D","9C","QS"]; break;
}

// Th√™m div hi·ªÉn th·ªã h√¨nh ·∫£nh mini, cƒÉn gi·ªØa, fade-in
if(exampleCards.length){
  htmlResult += "<div class='example-cards' style='text-align:center;'>";
  exampleCards.forEach(code => {
    htmlResult += `<img class="mini-card fade-card" src="cards/${code}.png" alt="${code}">`;
  });
  htmlResult += "</div>";
}

document.getElementById("ketquaPoker").innerHTML = htmlResult;

// Fade-in cho mini cards
requestAnimationFrame(() => { 
  document.querySelectorAll(".mini-card.fade-card").forEach(img => img.classList.add("show")); 
});

MathJax.typesetPromise();


}



    document.getElementById("toggleTheme").addEventListener("click", function(){
      document.body.classList.toggle("dark");
      this.textContent = document.body.classList.contains("dark") ? "‚òÄÔ∏è" : "üåô";
    });

    choiLai();
  </script>
<meta charset="UTF-8">
<footer id="copyright"></footer>

<script>
  // Base64 ƒë√∫ng (ch·ªØ Qu√Ω)
  const b64Copyright = "TMOqIFbEg24gUXXDvSwgVEhQVCBCw6xuaCBTxqFuLCBRdeG6o25nIE5nw6Np";

  const bytes = Uint8Array.from(atob(b64Copyright), c => c.charCodeAt(0));
  const text  = new TextDecoder("utf-8").decode(bytes);

  // Ki·ªÉm tra nhanh tr√™n console: ph·∫£i in ƒë√∫ng "¬© 2025 L√™ VƒÉn Qu√Ω+GPT. All rights reserved."
  console.log(text);

  document.getElementById("copyright").textContent = text;

  // (tu·ª≥ ch·ªçn) ch·∫∑n chu·ªôt ph·∫£i & Ctrl+C nh∆∞ b·∫°n ƒë√£ l√†m
  document.addEventListener("contextmenu", e => e.preventDefault());
  document.addEventListener("keydown", e => {
    if (e.ctrlKey && e.key.toLowerCase() === "c") {
      e.preventDefault();
      alert("!");
    }
  });
</script>

</body>
</html>

